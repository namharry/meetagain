{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}MeetAgain{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap, FontAwesome, Custom CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link href="{% static 'css/style.css' %}" rel="stylesheet">

  <!-- Kakao Map -->
  <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=f387153e7e5f423d38f1a6d392d6bef8&libraries=services"></script>

  <!-- Alpine.js -->
  <script src="https://unpkg.com/alpinejs" defer></script>

  {% block extra_head %}{% endblock %}
  {% block extra_css %}{% endblock %}
</head>
<body>

<!-- ì „ì²´ ë ˆì´ì•„ì›ƒ Alpine ì»¨íŠ¸ë¡¤ -->
<div x-data="{ menuOpen: false }" class="container-fluid mt-4 position-relative">

  <!-- âœ… ë¡œê·¸ì¸/íšŒì›ê°€ì…/ë¹„ë²ˆì¬ì„¤ì • í˜ì´ì§€ì—ì„œëŠ” ìƒë‹¨ ì•„ì´ì½˜ ìˆ¨ê¸°ê¸° -->
  {% if request.path != '/users/login/' and request.path != '/users/signup/' and request.path != '/users/password_reset/' %}
  <div class="top-icons d-flex justify-content-end gap-3">
    <i class="fa-solid fa-bell" onclick="toggleSidebar()" style="cursor:pointer;"></i>
    <!-- í–„ë²„ê±° ë²„íŠ¼: í´ë¦­ ì‹œ menuOpen í† ê¸€ -->
    <i class="fa-solid fa-bars" @click="menuOpen = !menuOpen" style="cursor: pointer;"></i>
  </div>
  {% endif %}

  <!-- ğŸ‘‰ ì‚¬ì´ë“œ ë©”ë‰´ (ìŠ¬ë¼ì´ë”©) -->
  <div
    class="position-fixed top-0 start-0 bg-white shadow p-4"
    x-show="menuOpen"
    x-transition
    @click.outside="menuOpen = false"
    style="width: 240px; height: 100vh; z-index: 1050;"
  >
    <h5 class="mb-4">ğŸ“‚ ë©”ë‰´</h5>
    <ul class="list-unstyled">
      <li><a href="{% url 'meetagain:index' %}" class="text-decoration-none d-block py-2">ğŸ  í™ˆ</a></li>
      <li><a href="{% url 'meetagain:founditem_form' %}" class="text-decoration-none d-block py-2">ğŸ“¥ ìŠµë“ë¬¼ ë“±ë¡</a></li>
      <li><a href="{% url 'meetagain:register' %}" class="text-decoration-none d-block py-2">ğŸ” ë¶„ì‹¤ë¬¼ ì‹ ê³ </a></li>
      <li><a href="{% url 'meetagain:index' %}#items" class="text-decoration-none d-block py-2">ğŸ“„ ëª©ë¡ ë³´ê¸°</a></li>
      <li><a href="{% url 'meetagain:notification_list' %}" class="text-decoration-none d-block py-2">ğŸ”” ì•Œë¦¼</a></li>
    </ul>
  </div>

  <!-- ğŸ”” ì•Œë¦¼ ì‚¬ì´ë“œë°” -->
  {% include "pages/alert_sidebar.html" %}

  <!-- ë©”ì¸ ì½˜í…ì¸  -->
  {% if messages %}
    <div class="container mt-3">
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }}">
          {{ message }}
        </div>
      {% endfor %}
    </div>
  {% endif %}
  {% block content %}{% endblock %}

</div>

<!-- ê³µí†µ ìŠ¤í¬ë¦½íŠ¸ -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" defer></script>

<!-- ì „ì—­: ì•Œë¦¼ ì‚¬ì´ë“œë°” í† ê¸€ & í‚¤ì›Œë“œ ë¡œì§ -->
<script>
  window.toggleSidebar = function () {
    const el = document.getElementById('alertSidebar');
    if (!el) return;
    const isOpen = el.dataset.open === '1';
    el.style.right = isOpen ? '-400px' : '0';
    el.dataset.open = isOpen ? '0' : '1';
  };
  window.toggleKeywordInput = function () {
    const g = document.getElementById('keywordInputGroup');
    if (!g) return;
    g.style.display = (g.style.display === 'none' || !g.style.display) ? 'block' : 'none';
  };
  window.addKeyword = function () {
    const input = document.getElementById('keywordInput');
    const list = document.getElementById('keywordList');
    if (!input || !list) return;
    const text = (input.value || '').trim();
    if (!text) return;
    const pill = document.createElement('span');
    pill.className = 'badge rounded-pill text-bg-light me-1 mb-1';
    pill.textContent = text;
    const removeBtn = document.createElement('button');
    removeBtn.type = 'button';
    removeBtn.className = 'btn btn-sm btn-link text-danger ms-1 p-0';
    removeBtn.textContent = 'Ã—';
    removeBtn.onclick = () => pill.remove();
    pill.appendChild(removeBtn);
    list.appendChild(pill);
    input.value = '';
  };
</script>

{% block extra_scripts %}{% endblock %}
{% block script %}{% endblock %}
</body>
</html>
