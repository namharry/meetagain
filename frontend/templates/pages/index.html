{% extends 'base/base.html' %}
{% block title %}MeetAgain - ë¶„ì‹¤ë¬¼ ì¡°íšŒ{% endblock %}

{% block content %}
<div class="container-fluid mt-4 position-relative">
    <h4 class="text-center mb-4 fw-bold" style="font-size: 24px;">MeetAgain</h4>

    <div class="row">
        <div class="col-md-7">
            <div class="border p-4 bg-light mb-4">
                <h5>ğŸ” ë¶„ì‹¤ë¬¼ ì¡°íšŒ</h5>
                <div class="row g-2">
                    <div class="col-md-6">
                        <label class="form-label">ì¢…ë¥˜</label>
                        <select id="typeSelect" class="form-select" onchange="updateSubOptions()">
                            <option selected disabled>ì¢…ë¥˜ ì„ íƒ</option>
                            <option>ê°€ë°©</option>
                            <option>ê·€ê¸ˆì†</option>
                            <option>ì˜ë¥˜</option>
                            <option>ì „ìê¸°ê¸°</option>
                            <option>ì§€ê°‘</option>
                            <option>ì»´í“¨í„°</option>
                            <option>ì¹´ë“œ</option>
                            <option>í˜„ê¸ˆ</option>
                            <option>íœ´ëŒ€í°</option>
                            <option>ê¸°íƒ€</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">ì„¸ë¶€ì˜µì…˜</label>
                        <select id="subOptionSelect" class="form-select">
                            <option selected disabled>ì„¸ë¶€ì˜µì…˜ ì„ íƒ</option>
                        </select>
                    </div>
                    <div class="col-md-12">
                        <label class="form-label">ë¶„ì‹¤ë¬¼ëª…</label>
                        <input type="text" class="form-control" placeholder="ì˜ˆ: íŒŒë€ìƒ‰ ìš°ì‚°">
                    </div>
                    <div class="col-md-12">
                        <label class="form-label">ë¶„ì‹¤ ê¸°ê°„</label>
                        <div class="d-flex gap-2">
                            <input type="date" class="form-control">
                            <span class="align-self-center">~</span>
                            <input type="date" class="form-control">
                        </div>
                    </div>
                    <div class="col-md-12">
                        <label class="form-label">ë¶„ì‹¤ ì¥ì†Œ</label>
                        <select class="form-select">
                            <option selected disabled>ì¥ì†Œ ì„ íƒ</option>
                            <option>ë‚œí–¥ê´€</option>
                            <option>ì„±ì‹ ê´€</option>
                            <option>ìˆ˜ì •ê´€</option>
                            <option>ì¤‘ì•™ë„ì„œê´€</option>
                            <option>ì¡°í˜•1ê´€</option>
                            <option>ì¡°í˜•2ê´€</option>
                            <option>ì²´ìœ¡ê´€</option>
                            <option>í”„ë¼ì„ê´€</option>
                            <option>í–‰ì •ê´€</option>
                            <option>í•™ìƒíšŒê´€</option>
                            <option>ìŒì•…ê´€</option>
                            <option>ê¸°íƒ€</option>
                        </select>
                    </div>
                    <div class="col-12 text-end mt-3">
                        <button class="btn btn-primary">ê²€ìƒ‰</button>
                    </div>
                </div>
            </div>
            <h5 class="mb-3">ğŸ“‹ ë“±ë¡ëœ ë¶„ì‹¤ë¬¼ ë¦¬ìŠ¤íŠ¸</h5>
            <div class="row row-cols-1 row-cols-md-3 g-4 mb-4">
                <!-- ì¶”í›„ ë°˜ë³µë¬¸ìœ¼ë¡œ ë¶„ì‹¤ë¬¼ ì¹´ë“œ í‘œì‹œ -->
            </div>
        </div>

        <div class="col-md-5">
            <div id="map" style="width:100%; height:350px; background:#eee;"></div>
            <div class="map-buttons d-flex gap-2 mt-3">
                <a href="/found/register" class="btn btn-found px-5 py-5 w-50 flex-fill">
                    ğŸ“¥ ë¬¼ê±´ì„ ì£¼ì› ì–´ìš”!<br><small>(ìŠµë“ë¬¼ ë“±ë¡)</small>
                </a>
                <a href="/lost/report" class="btn btn-lost px-5 py-5 w-50 flex-fill">
                    ğŸ“¤ ë¬¼ê±´ì„ ìƒì–´ë²„ë ¸ì–´ìš”..<br><small>(ë¶„ì‹¤ë¬¼ ì‹ ê³ )</small>
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    // ====== ì¢… ì•„ì´ì½˜ ì‚¬ì´ë“œë°” í† ê¸€ ======
    // (base.htmlì— ì´ë¯¸ ìˆìœ¼ë©´ ì´ ë¸”ë¡ì€ ìƒëµí•´ë„ OK)
    window.toggleSidebar = window.toggleSidebar || function () {
        const el = document.getElementById('alertSidebar');
        if (!el) return;
        const isOpen = el.dataset.open === '1';
        el.style.right = isOpen ? '-400px' : '0';
        el.dataset.open = isOpen ? '0' : '1';
    };

    // í‚¤ì›Œë“œ ì…ë ¥ ì˜ì—­ í† ê¸€
    window.toggleKeywordInput = window.toggleKeywordInput || function () {
        const g = document.getElementById('keywordInputGroup');
        if (!g) return;
        g.style.display = (g.style.display === 'none' || !g.style.display) ? 'block' : 'none';
    };

    // í‚¤ì›Œë“œ ì¶”ê°€ (ê°„ë‹¨ ë²„ì „: í™”ë©´ì—ë§Œ ì¶”ê°€)
    window.addKeyword = window.addKeyword || function () {
        const input = document.getElementById('keywordInput');
        const list = document.getElementById('keywordList');
        if (!input || !list) return;

        const text = (input.value || '').trim();
        if (!text) return;

        const pill = document.createElement('span');
        pill.className = 'badge rounded-pill text-bg-light me-1 mb-1';
        pill.textContent = text;

        const removeBtn = document.createElement('button');
        removeBtn.type = 'button';
        removeBtn.className = 'btn btn-sm btn-link text-danger ms-1 p-0';
        removeBtn.textContent = 'Ã—';
        removeBtn.onclick = () => pill.remove();

        pill.appendChild(removeBtn);
        list.appendChild(pill);
        input.value = '';
    };

    // ====== í¼ ì„¸ë¶€ì˜µì…˜ ì±„ìš°ê¸° ======
    const subOptions = {
        "ê·€ê¸ˆì†": ["ë°˜ì§€", "ëª©ê±¸ì´", "ê·€ê±¸ì´", "ì‹œê³„", "ê¸°íƒ€"],
        "ì˜ë¥˜": ["ëª¨ì", "ì‹ ë°œ", "ì•„ìš°í„°", "ê¸°íƒ€ì˜ë¥˜"],
        "ì „ìê¸°ê¸°": ["íƒœë¸”ë¦¿", "ìŠ¤ë§ˆíŠ¸ì›Œì¹˜", "ë¬´ì„ ì´ì–´í°", "ì¹´ë©”ë¼", "í—¤ë“œì…‹", "ê¸°íƒ€ìš©í’ˆ"]
    };
    window.updateSubOptions = function () {
        const type = document.getElementById("typeSelect")?.value;
        const subSelect = document.getElementById("subOptionSelect");
        if (!subSelect) return;
        subSelect.innerHTML = '<option disabled selected>ì„¸ë¶€ì˜µì…˜ ì„ íƒ</option>';
        if (subOptions[type]) {
            subOptions[type].forEach(opt => {
                const o = document.createElement("option");
                o.value = o.text = opt;
                subSelect.appendChild(o);
            });
        } else if (type) {
            const o = document.createElement("option");
            o.text = "í•´ë‹¹ ì—†ìŒ";
            subSelect.appendChild(o);
        }
    };

    // ====== Kakao Map ======
    document.addEventListener('DOMContentLoaded', function () {
        const container = document.getElementById('map');
        if (!container || typeof kakao === 'undefined' || !kakao.maps) return;

        const map = new kakao.maps.Map(container, {
            center: new kakao.maps.LatLng(37.591360, 127.021961),
            level: 2
        });
    });
</script>
{% endblock %}
